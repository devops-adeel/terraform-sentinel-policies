# Block use of resource blocks from root terraform files

import "tfplan"

# Rule to bar resources from root module
no_resources_in_root_module = rule {
  print("Number of resources in root module:", length(tfplan.resources)) and
  length(tfplan.resources) is 0
}
  
main = rule {
  no_resources_in_root_module
}
